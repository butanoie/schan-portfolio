!function(){"use strict";function Gumby(){this.$dom=$(document);this.isOldie=!!this.$dom.find("html").hasClass("oldie");this.click=this.detectClickEvent();this.uiModules={};this.inits={};this.onReady=false;this.onOldie=false;var scope=this;this.$dom.ready(function(){if(scope.isOldie&&scope.onOldie){scope.onOldie()}})}Gumby.prototype.init=function(){this.initUIModules();if(this.onReady){this.onReady()}};Gumby.prototype.debug=function(){return{$dom:this.$dom,isOldie:this.isOldie,uiModules:this.uiModules}};Gumby.prototype.ready=function(code){if(code&&typeof code==="function"){this.onReady=code}};Gumby.prototype.oldie=function(code){if(code&&typeof code==="function"){this.onOldie=code}};Gumby.prototype.selectAttr=function(){var i=0;for(;i<arguments.length;i++){var attr=arguments[i],dataAttr="data-"+arguments[i],gumbyAttr="gumby-"+arguments[i];if(this.attr(dataAttr)){return this.attr(dataAttr)}else if(this.attr(gumbyAttr)){return this.attr(gumbyAttr)}else if(this.attr(attr)){return this.attr(attr)}}return false};Gumby.prototype.addInitalisation=function(ref,code){this.inits[ref]=code};Gumby.prototype.initialize=function(ref){if(this.inits[ref]&&typeof this.inits[ref]==="function"){this.inits[ref]()}};Gumby.prototype.UIModule=function(data){var module=data.module;this.uiModules[module]=data};Gumby.prototype.initUIModules=function(){var x;for(x in this.uiModules){this.uiModules[x].init()}};Gumby.prototype.detectClickEvent=function(){if(Modernizr.touch){this.setupTapEvent();return"gumbyTap"}else{return"click"}};Gumby.prototype.setupTapEvent=function(){$.event.special.gumbyTap={setup:function(data){$(this).bind("touchstart touchend touchmove",$.event.special.gumbyTap.handler)},teardown:function(){$(this).unbind("touchstart touchend touchmove",$.event.special.gumbyTap.handler)},handler:function(event){var $this=$(this);if(event.type==="touchstart"){$this.data("gumbyTouchStart",true)}else if(event.type==="touchmove"){$this.data("gumbyTouchStart",false)}else if($this.data("gumbyTouchStart")){$this.data("gumbyTouchStart",false);event.type="gumbyTap";$this.click(function(e){e.stopImmediatePropagation()});$.event.handle.apply(this,arguments)}}}};window.Gumby=new Gumby}();!function(){"use strict";function Retina($el){this.$el=$el;this.imageSrc=this.$el.attr("src");this.retinaSrc=this.fetchRetinaImage();this.$retinaImg=$(new Image);var scope=this;if(!this.retinaSrc){return false}this.$retinaImg.attr("src",this.retinaSrc).load(function(){scope.retinaImageLoaded()})}Retina.prototype.fetchRetinaImage=function(){var imgSrc=this.imageSrc,index=this.imageSrc.search(/(\.|\/)(gif|jpe?g|png)$/i);if(index<0){return false}return imgSrc.substr(0,index)+"@2x"+imgSrc.substr(index,imgSrc.length)};Retina.prototype.retinaImageLoaded=function(){this.$el.attr("src",this.$retinaImg.attr("src")).trigger("gumby.onRetina")};Gumby.addInitalisation("retina",function(){if(!window.devicePixelRatio||window.devicePixelRatio<=1){return}$("img[data-retina],img[gumby-retina],img[retina]").each(function(){var $this=$(this);if($this.data("isRetina")){return true}$this.data("isRetina",true);new Retina($this)})});Gumby.UIModule({module:"retina",events:["onRetina"],init:function(){Gumby.initialize("retina")}})}();window.Gumby.init();if(typeof define=="function"&&define.amd){define(window.Gumby)}